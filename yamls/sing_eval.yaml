description: Evaluate super-glue for in-context setting

target:
  service: sing
  name: gcrprojvc1
  resource_group: gcr-singularity-proj1

environment:
  image: amlt-sing/pytorch-1.9.0-cuda11.3-cudnn8-devel
  setup:
    - pip install transformers --user
    - pip install datasets --user

code:
  local_dir: $CONFIG_DIR/../

storage:
  yutao:
    storage_account_name: msranlpintern
    container_name: yutao

search:
  job_template:
    name: many-{task}-balance-k{k}-parallel
    sku: G4
    priority: High
    command:
    - python3 eval.py --demo_num {k} --task {task} --data_path /mnt/yutao/data --select_method {method} --parallelize
  
  type: grid
  max_trials: 500
  params:
    - name: k
      spec: discrete
      values: [6, 12, 24]
    - name: task
      spec: discrete
      values: ["cb", "boolq"]
    - name: method
      spec: discrete
      values: ["align_feature", "loss_partition"]

# search:
#   job_template:
#     name: many-{task}-balance-k{k}
#     sku: G1
#     priority: High
#     command:
#     - python3 eval.py --demo_num {k} --task {task} --data_path /mnt/yutao/data

#   type: grid
#   max_trials: 500
#   params:
#     - name: k
#       spec: discrete
#       values: [6, 12, 24]
#     - name: task
#       spec: discrete
#       values: ["copa"]
  

