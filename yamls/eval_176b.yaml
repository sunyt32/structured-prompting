description: Evaluate core-shot in-context setting

target:
  service: amlk8s
  name: a100-80gb-cus
  vc: TuringNLP

environment:
  image: itp/torch1.9-cuda11.3-base:latest
  registry: shumingdocker.azurecr.io
  setup:
    - pip install --upgrade torch torchvision --extra-index-url https://download.pytorch.org/whl/cu113
    - pip install datasets accelerate matplotlib bitsandbytes --user
    - pip uninstall enum34
    - pip install git+https://github.com/huggingface/transformers.git --user
    # - pip install git+https://github.com/microsoft/DeepSpeed.git --user
  username: shumingdocker

code:
  local_dir: $CONFIG_DIR/../

storage:
  yutao:
    storage_account_name: msranlpintern
    container_name: yutao

search:
  job_template:
    name: many-{task}-chunk{k}-{method}-bloom
    sku: G8
    priority: High
    command:
    - python3 eval_many.py --chunk_num {k} --task {task} --model bloom
     --data_path /mnt/yutao/data
     --log_path /mnt/yutao/core-shot/log/{task}_{k}_bloom_many.json
  
  type: grid
  max_trials: 500
  params:
    - name: k
      spec: discrete
      values: [1, 3, 5]
    - name: task
      spec: discrete
      values: ["boolq", "rte", "cb", "sst2", "sst5", "trec", "subj", "mr", "obqa", "piqa"]
      # values: ["dbpedia", "boolq", "rte", "cb", "agnews", "sst2", "sst5", "trec", "subj", "hellaswag", "piqa", "copa", "winogrande", "mr", "arcc", "arce", "obqa"]

  
  
